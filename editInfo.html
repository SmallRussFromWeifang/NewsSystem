<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<script type="text/javascript" src="js/jquery/2.0.0/jquery.min.js"></script>
		<link rel="stylesheet" href="css/bootstrap/3.3.6/bootstrap.min.css" />
		<script type="text/javascript" src="js/bootstrap/3.3.6/bootstrap.min.js"></script>
		<link rel="stylesheet" href="css/style.css" />
		<link rel="stylesheet" href="css/main.css" />
		<link rel="stylesheet" href="css/element-ui.css">
		<script type="text/javascript" src="js/vue.min.js"></script>
		<script src="js/element-ui.js"></script>
		<link rel="stylesheet" href="css/buttons.css" />
		<link rel="stylesheet" href="css/myGit.css" />
		<link rel="stylesheet" href="css/editInfo.css" />
		<title>个人中心--稷下新闻</title>
	</head>

	<body>
		<div id="app">
			
			<nav class='navbar navbar-inverse navbar-fixed-top'>
				<div class='container'>
					<div class='navbar-header'>
						<a href='index.html'>
							<img src='img/Logo.png' />
							<p>稷下新闻</p>
						</a>
					</div>
					<div class='collapse navbar-collapse' id='example-navbar-collapse'>
						<ul class='nav navbar-nav _nav'>
							<li class='active'>
								<a href='index.html'>
									<span class='glyphicon glyphicon-home'></span> 首 页</a>
							</li>
							<li>
								<a href='inLand.html'>国内</a>
							</li>
							<li>
								<a href='outLand.html'>国际</a>
							</li>
							<li>
								<a href='#'>军事</a>
							</li>
							<li>
								<a href='gitMaster.html'>警法</a>
							</li>
							<li class='dropdown'>
								<a href='#' class='dropdown-toggle' data-toggle='dropdown'>
									专题<b class='caret'></b>
								</a>
								<ul class='dropdown-menu'>
									<li>
										<a href='#'>专题1.0</a>
									</li>
									<li>
										<a href='#'>专题1.1</a>
									</li>
									<li>
										<a href='#'>专题1.2</a>
									</li>
									<li class='divider'></li>
									<li>
										<a href='#'>专题2.0</a>
									</li>
									<li class='divider'></li>
									<li>
										<a href='#'>专题3.0</a>
									</li>
								</ul>
							</li>
						</ul>
						<div class='navbar-right' style="color: white; margin-top: 10px;">
							<span>嗨，欢迎来稷下新闻</span> 
							<a href="editInfo.html"><span>{{username}}</span></a>
							<a href="login_register.html" v-if="btnM" class="button button-primary button-rounded button-small">登录</a>
						</div>

					</div>

				</div>

			</nav>
			<div class="container">
				<div class="Info_Header">
					<div class="row Info_bg">
					</div>
					<div class="row Info_pro">
						<div class="col-xs-2 my_ico">
							<img class="img-thumbnail" src="img/myIco.jpg" />
						</div>
						<div class="col-xs-9 my_pro">
							<h2>{{user.name}}</h2>
							<span class="glyphicon glyphicon-book"></span>个人简介
						</div>
					</div>
				</div>
			</div>
			<div class="container">
				<div class=" main_body">
					<div class="line1 row">
							<div class="col-xs-8 base panel panel-default">
								<el-form>
								<div class="base-item">
									<div class="base_head">
										<h4>基本信息</h4>
									</div>
									<el-divider></el-divider>
									<div class="base_conts">
										<el-form>
										<div class="info_item">
											<div class="info_2nd">
												<!--{{user.username}}--> 	
												<el-form-item label="用户名" prop="username">
												<el-input style="width: 200px;" v-model="user.username" :disabled="editUsername">
												</el-input>
												</el-form-item>
												<br>
											</div>

										</div>
										<div class="info_item">
											<div class="info_2nd">
												<el-form-item label="昵称" label-width="55px" prop="name">
												<el-input style="width: 200px;" v-model="user.name" :disabled="editName">
												</el-input>
												</el-form-item>
												<br>
											</div>
										</div>
									</div>
								</div>
								<div class="base-item" style="float: left;">
									<div class="base_head" >
										<h4>联系方式</h4>
									</div>
									<el-divider></el-divider>
									<div class="base_conts">
										<div class="info_item">
											<div class="info_2nd">
												<el-form-item label="手机" label-width="55px" prop="phone">
												<el-input style="width: 200px;" v-model="user.phone" :disabled="editPhone">
												</el-input>
												</el-form-item>
												<br>
											</div>
										</div>
										<div class="info_item">
											<div class="info_2nd">
												<el-form-item label="邮箱"  label-width="55px" prop="email">
												<el-input style="width: 200px;" v-model="user.email" :disabled="editEmail">
												</el-input>
												</el-form-item>
												<br>
											</div>

										</div>
									</div>
								</div>
								<div class="btns">
									<el-button class="btn button-action" @click="updateUser()">提交</el-button>
									<el-button class="btn button-action" @click="editCan()">编辑</el-button>
								</div>
								</el-form>
							</div>
							<div class="col-xs-4">
								<div class="list-group">
									<a href="#" class="list-group-item">
										<img src="img/favicon.ico" class="img-circle">你的评论数{{myComment}}
									</a>
									<a href="myGit.html" class="list-group-item active">
										<span class="glyphicon glyphicon-user"></span> 个人主页
									</a>
									<a href="gitMaster.html" class="list-group-item">
										<span class="glyphicon glyphicon-heart"></span> 关注
									</a>
									<a href="#" class="list-group-item">
										<span class="glyphicon glyphicon-envelope"></span> 私信
									</a>
								</div>
							</div>
					</div>
				</div>

			</div>

		</div>
		</div>
		<div class="container footer">
			<div class="row">
				<div class="ft-link">
					<a href="#">联系我们</a>
					<span>|</span>
					<a href="#">招贤纳士</a>
					<span>|</span>
					<a href="#">投诉建议</a>
				</div>
				<div class="ft-rights">
					Copyright Chen Xiansen　©1998-2017
				</div>
			</div>
		</div>
		</div>
		<script>
			new Vue({
				el: '#app',
				data() {
					return {
						username:'',
						editUsername:true,
						editName:true,
						editPhone:true,
						editEmail:true,
						myComment:'1',
						user: {},
						btnM:false
					}
				},
				methods: {
					editCan(){
						this.editUsername=false;
						this.editName=false;
						this.editPhone=false;
						this.editEmail=false;
					},
					updateUser(){
						var _this = this;
						$.ajax({
							url: 'http://localhost:8080/user/update',
							type: 'post',
							contentType: 'application/json',
							data: JSON.stringify(_this.user),
							dataType: 'json',
							success: function(data) {
								console.log(data);
								if(data.success) {
									_this.$message.success(data.message);
									_this.user = data.data;
									data.data = JSON.stringify(data.data);
									sessionStorage.setItem("user", data.data);
									sessionStorage.setItem("user", data.data);
									
									window.top.location.href = "editInfo.html";
									
								} else {
									_this.$message.error(data.message);
								}
							}
						});
					}
				},
				mounted() {
					this.user = JSON.parse(sessionStorage.getItem("user"));
					if(this.user==null) this.btnM = true;
					else this.username = this.user.name;
					console.log(this.user);
				}
			});
		</script>
	</body>

</html>